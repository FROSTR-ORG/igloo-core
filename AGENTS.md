# Repository Guidelines

## Project Structure & Module Organization
- `src/` holds the TypeScript sources grouped by capability (`keyset.ts`, `node.ts`, `peer.ts`, `nostr.ts`, `validation.ts`, etc.) with `index.ts` re-exporting the public API.
- `tests/` mirrors the module names with Jest specs (`*.test.ts`) and central mocks in `tests/__mocks__` for external packages.
- `examples/` contains runnable usage scripts; keep new walkthroughs here when showcasing flows.
- `dist/` is generated by the build; do not edit or commit manual changes. Use `npm run clean` before regenerating builds.

## Build, Test, and Development Commands
- `npm run build` compiles the library with `tsc` into `dist/`.
- `npm run watch` keeps the TypeScript compiler running for iterative work.
- `npm test` executes the full Jest suite against `src/` and `tests/`.
- `npm run test:coverage` produces coverage reports in `coverage/` and should accompany substantial feature work.
- `npm run demo`, `npm run examples`, and `npm run validate-example` compile first and execute the scripts in `examples/` to verify end-to-end flows.

## Coding Style & Naming Conventions
- Use TypeScript with two-space indentation and prefer named exports; classes (e.g., `IglooCore`) remain PascalCase while functions and constants follow lowerCamelCase.
- Keep relative imports with `.js` extensions to match the emitted ESM build (`type: "module"`).
- Run `npm run build` before committing to catch type regressions; rely on Jest for behavioural validation.

## Testing Guidelines
- Tests live in `tests/**/*.test.ts`; mirror new modules with corresponding specs and extend mocks when external calls need isolation.
- Use Jest and `ts-jest`; prefer descriptive `describe` and `it` blocks (`describe('peer', ...)`) to match existing style.
- Add coverage-focused cases when touching cryptography, networking, or validation logic; review the HTML report under `coverage/` when improving reliability.

## Commit & Pull Request Guidelines
- Follow Conventional Commits (`feat:`, `fix:`, `chore:`) as seen in recent history, and scope when helpful (e.g., `feat(peer): add monitor hooks`).
- Each PR should summarise intent, link related issues, and paste the latest `npm test` (and `npm run test:coverage` when relevant) output.
- Update README or `examples/` when API changes affect users, and avoid committing rebuilt `dist/` unless preparing a release tag.
